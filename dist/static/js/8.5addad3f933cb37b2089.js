webpackJsonp([8],{HoUZ:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("4YfN"),a=n.n(i),o=n("n2Gk"),s=n("h+y+"),l=n("nA34"),r=n("Yarq"),u=n.n(r),c=n("AA3o"),v=n.n(c),m=n("xSur"),d=n.n(m),h=n("UzKs"),p=n.n(h),g=n("Y7Ml"),f=n.n(g),I=n("vdk2"),_=n("9FjY"),y=new(function(e){function t(){return v()(this,t),p()(this,(t.__proto__||u()(t)).call(this))}return f()(t,e),d()(t,[{key:"getLiveChannel",value:function(e){return this.post("/live/getLiveInChannel",e)}},{key:"createNewLive",value:function(e){return this.post("/live/createNewLive",e)}},{key:"getLiveInfo",value:function(e){return this.post("/live/getLiveInfo",e)}},{key:"getDianboInfo",value:function(e){return this.get("/0.1/wechat/video/"+e)}},{key:"liveDetailMobile",value:function(e){return this.get("/video/liveDetailMobile?channelId="+e)}},{key:"getVedioInChannel",value:function(e){return this.get("/video/getVideoInChannel?channelId="+e)}},{key:"getMobileLiveInfo",value:function(e){return this.post("/mobile/livePlay",{channelId:e})}},{key:"getLiveHistory",value:function(e){return this.post("/mobile/getVideoInChannel",{channelId:e})}},{key:"getChatUserSig",value:function(){return this.get("/0.1/im/sig?userId=admin")}},{key:"groupMessageUrl",value:function(e,t,n){return"https://console.tim.qq.com/v4/group_open_http_svc/"+e+"?usersig="+t+"&sdkappid="+_.a.appid+"&identifier=admin&random="+n+"&contenttype=json"}},{key:"sendChatMessage",value:function(e,t){return this.post(this.groupMessageUrl("send_group_msg",e,t.Random),t)}},{key:"getHistoryChatMessage",value:function(e,t){return this.post(this.groupMessageUrl("group_msg_get_simple",e,t.Random),t)}},{key:"getRandomInt",value:function(){return parseInt(Math.random().toString().slice(2,10))}},{key:"liveUserData",value:function(e){return this.post("/live/userListStatistics",e)}},{key:"liveData",value:function(e){return this.post("/live/liveStatistics",e)}},{key:"dianboData",value:function(e){return this.post("/record/video",e)}},{key:"liveCountInfo",value:function(e){return this.post("/statistic/getChannelAndLive",e)}}]),t}(I.a)),w=(localStorage.getItem("userName"),{data:function(){return{name:"",location:"",date:"",time:"",timeEnd:"",info:"",channel:""}},watch:{channelId:function(e){this.channel=e}},methods:{submit:function(){if(""==this.name||""==this.info||""==this.location||""==this.time||""==this.date||""==this.timeEnd)alert("填写完信息再提交！");else{var e=this,t=sessionStorage.getItem("userId");y.createNewLive({userId:t,token:"",channelId:localStorage.getItem("channelId"),liveName:this.name,startTime:this.time,endTime:this.timeEnd,location:this.location}).then(function(t){0==t.data.retureValue?(alert("新建成功"),localStorage.setItem("liveId",t.data.retureData.liveId),e.$emit("newlive",{name:e.name,location:e.location,date:e.date,time:e.time,endtime:e.timeEnd,info:e.info}),e.name="",e.location="",e.date="",e.time="",e.timeEnd="",e.info=""):alert("创建失败")}).catch(function(e){console.log(e),alert("创建失败.")})}}}}),k={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"page-wrapper"}},[n("h1",[e._v("新建直播")]),e._v(" "),n("label",{attrs:{for:"text"}},[e._v("直播名称")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"name"}],attrs:{type:"text",id:"text"},domProps:{value:e.name},on:{input:function(t){t.target.composing||(e.name=t.target.value)}}}),e._v(" "),n("label",{attrs:{for:"place"}},[e._v("直播地点")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.location,expression:"location"}],attrs:{type:"text",id:"place"},domProps:{value:e.location},on:{input:function(t){t.target.composing||(e.location=t.target.value)}}}),e._v(" "),n("label",{attrs:{for:"date"}},[e._v("直播日期")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.date,expression:"date"}],attrs:{type:"date",id:"date"},domProps:{value:e.date},on:{input:function(t){t.target.composing||(e.date=t.target.value)}}}),e._v(" "),n("label",{attrs:{for:"datetime"}},[e._v("开始时间")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.time,expression:"time"}],attrs:{type:"text",id:"datetime"},domProps:{value:e.time},on:{input:function(t){t.target.composing||(e.time=t.target.value)}}}),e._v(" "),n("label",{attrs:{for:"timeend"}},[e._v("结束时间")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.timeEnd,expression:"timeEnd"}],attrs:{type:"text",id:"timeend"},domProps:{value:e.timeEnd},on:{input:function(t){t.target.composing||(e.timeEnd=t.target.value)}}}),e._v(" "),n("label",{attrs:{for:"content"}},[e._v("直播简介")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.info,expression:"info"}],attrs:{type:"text",id:"content"},domProps:{value:e.info},on:{input:function(t){t.target.composing||(e.info=t.target.value)}}}),e._v(" "),n("button",{on:{click:e.submit}},[e._v("提交")])])},staticRenderFns:[]};var N=n("Z0/y")(w,k,!1,function(e){n("voTn")},"data-v-18ec9330",null).exports,b=n("9rMa"),L=(n("p7Eg"),{data:function(){return{isShow:!1,messages:"",title:""}},components:{Shelf:o.a,videoCard:s.a,Button:l.a,liveInput:N},created:function(){console.log("hahahah"),this.fetchData(),this.title=localStorage.getItem("liveTitle");var e=this,t=localStorage.getItem("channelId");y.getLiveChannel({channelId:t}).then(function(t){if(0==t.data.retureValue){console.log(t.data.retureData);for(var n=0;n<t.data.retureData.length;n++){var i=t.data.retureData[n];i.imgLocation||(i.imgLocation="static/imgs/cover2.jpg"),i.playNum||(i.playNum=100),i.viewNum||(i.viewNum=50),i.channelName||(i.channelName=i.liveName),e.$store.state.liveList.push(i)}}}).catch(function(e){console.log(e)})},watch:{$route:"fetchData"},computed:a()({},Object(b.c)(["liveList"])),methods:a()({},Object(b.b)(["ADD_LIVE"]),{newlive:function(){this.isShow=!this.isShow},handlelive:function(e){this.messages=e,this.isShow=!1,this.ADD_LIVE({imgLocation:"static/imgs/cover2.jpg",channelName:this.messages.name,playNum:0,viewNum:0})},fetchData:function(){this.$store.state.liveList=[],console.log(this.$route),this.$route.params.nameId&&localStorage.setItem("liveTitle",this.$route.params.nameId),this.$route.params.channelId&&localStorage.setItem("channelId",this.$route.params.channelId)},toLive:function(e,t){null==t&&(t=localStorage.getItem("liveId")),console.log(e,t),this.$router.push({name:"viewVideo",params:{nameId:e,liveId:t}})}})}),S={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("section",{staticClass:"mt30 clearfix"},[n("Shelf",{attrs:{title:e.title}}),e._v(" "),n("Button",{staticClass:"button",attrs:{text:"新建直播"},on:{btnClick:e.newlive}}),e._v(" "),n("liveInput",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],staticClass:"input",on:{newlive:e.handlelive}}),e._v(" "),n("div",{staticClass:"homevideo"},e._l(e.liveList,function(t,i){return n("videoCard",{key:i,attrs:{msg:t},on:{cardClick:function(n){e.toLive(t.channelName,t.liveId)}}})}))],1)])},staticRenderFns:[]};var x=n("Z0/y")(L,S,!1,function(e){n("YUnH")},"data-v-4381e224",null);t.default=x.exports},YUnH:function(e,t){},voTn:function(e,t){}});
//# sourceMappingURL=8.5addad3f933cb37b2089.js.map