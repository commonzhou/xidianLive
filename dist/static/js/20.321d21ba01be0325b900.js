webpackJsonp([20],{IEPA:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("4YfN"),o=a.n(s),n=a("n2Gk"),l=a("v4Kd"),i=a("eEfO"),c=a("9rMa"),r={name:"form",components:{Shelf:n.a,subTitle:i.a},mounted:function(){var e=this,t=this.$refs.feedbackContainer,a=t.$el.parentNode;a.style.height=a.parentNode.style.height="100%",this.tableHeight=t.$el.clientHeight-65,window.addEventListener("resize",function(){e.tableHeight=t.$el.clientHeight-65}),this._getFeedbackList()},data:function(){return{tableHeight:0,feedbackList:[],showDetailDialog:!1,showDelDialog:!1,chosenFeedback:null,Images:Images}},created:function(){var e=this;sessionStorage.getItem("userName");l.a.liveUserData({liveId:"123"}).then(function(t){if(0==t.data.retureValue){console.log(t.data.retureData),e.$store.state.liveUser=[];for(var a=0;a<t.data.retureData.length;a++){var s=t.data.retureData[a];e.$store.state.liveUser.push(s)}}else alert("加载失败")}).catch(function(e){console.log(e),alert("加载失败.")})},computed:o()({},Object(c.c)(["liveUser"])),methods:{showFeedbackDetail:function(e){this.chosenFeedback=e,this.showDetailDialog=!0},confirmReceiveFeedback:function(){var e=this;this.showDetailDialog=!1,feedbackApi.handleFeedback(this.chosenFeedback.id).then(function(t){console.log(t),0===t.code&&(console.log("查看成功！"),e._getFeedbackList())}).catch(function(e){console.log(e)})},showDelConfirm:function(e){this.chosenFeedback=e,this.showDelDialog=!0},confirmDelFeedback:function(){var e=this;this.showDelDialog=!1,feedbackApi.delFeedback(this.chosenFeedback.id).then(function(t){0===t.code?(e.$message({message:"信息删除成功!",type:"success"}),e._getFeedbackList()):e.$message({message:"信息删除失败!",type:"error"})}).catch(function(e){console.log(e)})},_getFeedbackList:function(){var e=this;feedbackApi.getData("/admin/feedback/getInfoList").then(function(t){console.log(t),0===t.code&&(e.feedbackList=t.data.list.map(function(e){return{handled:1===e.handled,id:e.id,date:moment(e.time,"YYYY-MM-DD HH:mm").fromNow(),user:e.user,content:e.content.content}}))}).catch(function(e){console.log(e)})}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"feedback-wrapper"},[a("subTitle",{attrs:{title:"用户列表"}}),e._v(" "),a("section",{staticClass:"mt30 clearfix"},[a("Shelf",{attrs:{title:"直播观看人列表"}}),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.feedbackList,border:"",height:e.tableHeight}},[a("el-table-column",{attrs:{type:"index",label:"#",align:"center",resizable:!1,width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"user.id",label:"用户ID",align:"center",resizable:!1,width:"240"}}),e._v(" "),a("el-table-column",{attrs:{label:"用户头像",align:"center",resizable:!1,width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top","open-delay":500}},[a("user-info-tooltip",{attrs:{user:t.row.user}}),e._v(" "),a("div",{staticClass:"avatar-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("i",{style:{backgroundImage:"url("+(t.row.user.avator||("男"===t.row.user.gender?e.Images.MaleNull:e.Images.FemaleNull))+")"}})])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"date",width:"400",align:"center",resizable:!1,label:"观看时间"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"状态",width:"253",resizable:!1},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.handled?a("p",{staticClass:"handled"},[a("span",[e._v("已查看")]),e._v(" "),a("a",{staticClass:"del-feedback",attrs:{href:"javascript:void(0)"},on:{click:function(a){a.stopPropagation(),e.showDelConfirm(t.row)}}},[e._v("删除")])]):a("p",{staticClass:"unhandled"},[e._v("未查看")])]}}])})],1),e._v(" "),e.chosenFeedback?a("el-dialog",{attrs:{title:"反馈内容",visible:e.showDetailDialog,center:""},on:{"update:visible":function(t){e.showDetailDialog=t}}},[a("section",{staticClass:"dialog-content"},[a("header",[a("p",[e._v("\n            用户 \n            "),a("i",{style:{backgroundImage:"url("+(e.chosenFeedback.user.avator||("男"===e.chosenFeedback.user.gender?e.Images.MaleNull:e.Images.FemaleNull))+")"}}),e._v(" \n            "+e._s(e.chosenFeedback.user.nickName)+" \n            反馈：\n          ")])]),e._v(" "),a("p",{staticClass:"d-content"},[e._v(e._s(e.chosenFeedback.content))]),e._v(" "),a("p",[e._v("反馈时间："),a("time",[e._v(e._s(e.chosenFeedback.date))])])]),e._v(" "),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.confirmReceiveFeedback}},[e._v("确 定")])],1)]):e._e(),e._v(" "),a("el-dialog",{attrs:{title:"提示",visible:e.showDelDialog,size:"tiny"},on:{"update:visible":function(t){e.showDelDialog=t}}},[a("span",[e._v("您确定要删除当前选中的反馈信息吗？")]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.showDelDialog=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDelFeedback}},[e._v("确 定")])],1)])],1)],1)},staticRenderFns:[]};var u=a("Z0/y")(r,d,!1,function(e){a("hj2P")},"data-v-1eea0a25",null);t.default=u.exports},hj2P:function(e,t){}});
//# sourceMappingURL=20.321d21ba01be0325b900.js.map